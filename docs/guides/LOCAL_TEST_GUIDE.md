# 📋 本地功能测试指南

## 🚀 环境准备状态
✅ **已完成的准备工作**：
- Node.js v24.4.1 & npm v11.4.2 已安装
- PostgreSQL 数据库已连接并同步
- 数据库种子数据已初始化（2用户、3项目、4分析）
- Next.js 开发服务器已启动 (http://localhost:3000)

## 🧪 手动功能测试步骤

### Step 1: 访问应用主页
1. 打开浏览器访问: http://localhost:3000
2. **验证点**：
   - 页面应该直接显示主界面（无需登录）
   - 应该看到 "ScriptAI MVP" 标题
   - 应该有"开始分析"或"上传剧本"按钮

### Step 2: 测试剧本上传功能
1. 点击"开始分析"或"上传剧本"
2. **测试方式A - 文本粘贴**：
   ```
   场景 1：咖啡店 - 日 - 内

   张明（30岁，程序员）坐在角落，对着笔记本电脑工作。

   李华走进来，看到张明后犹豫了一下。

   李华：还记得我吗？我们昨天才第一次见面。

   张明：（困惑）昨天？可是我记得我们认识很多年了。

   李华：你在说什么？我们昨天在图书馆第一次碰面的。
   ```

3. **测试方式B - 文件上传**：
   - 准备一个 .txt 或 .docx 文件
   - 使用文件上传功能

4. **验证点**：
   - 上传界面响应正常
   - 可以粘贴文本或选择文件
   - 点击"分析"按钮后显示加载状态

### Step 3: 验证AI分析功能
1. 提交剧本后等待分析完成
2. **验证点**：
   - 显示分析进度或加载动画
   - 分析完成后显示检测到的逻辑错误
   - 错误类型应包括：
     * 时间线不一致
     * 角色行为矛盾
     * 场景连续性问题
     * 对话逻辑错误
     * 道具/环境不一致

### Step 4: 测试交互式修改
1. 查看每个检测到的错误
2. 对于每个修改建议：
   - 点击"接受"接受修改
   - 点击"拒绝"拒绝修改
3. **验证点**：
   - 修改建议卡片显示正常
   - 接受/拒绝按钮响应正常
   - 可以看到修改前后的对比
   - 支持撤销/重做操作

### Step 5: 测试导出功能
1. 完成修改后，点击"导出"
2. 选择导出格式：
   - .txt 格式
   - .docx 格式
3. **验证点**：
   - 导出功能正常工作
   - 下载的文件包含修改后的剧本
   - 格式正确

## 🔧 API测试命令

### 测试健康检查端点
```bash
curl http://localhost:3000/api/health
```

### 测试项目列表（使用默认用户）
```bash
curl http://localhost:3000/api/projects
```

### 测试分析提交
```bash
curl -X POST http://localhost:3000/api/analysis \
  -H "Content-Type: application/json" \
  -d '{
    "projectId": "1",
    "scriptContent": "测试剧本内容",
    "scriptFormat": "text"
  }'
```

## 📊 性能验证

### 关键性能指标
- **分析响应时间**: 应 < 10秒
- **页面加载时间**: 应 < 3秒
- **交互响应**: 应 < 500ms

### 性能测试命令
```bash
# 测量API响应时间
time curl -X POST http://localhost:3000/api/analysis \
  -H "Content-Type: application/json" \
  -d '{"projectId": "1", "scriptContent": "test"}'
```

## 🐛 常见问题排查

### 1. 页面无法访问
- 检查开发服务器日志
- 确认端口3000未被占用
- 检查 .env 文件配置

### 2. 数据库连接失败
```bash
# 验证数据库连接
npx prisma db push --skip-generate
```

### 3. AI分析失败
- 检查 DEEPSEEK_API_KEY 是否配置
- 查看控制台错误信息
- 验证网络连接

## 📝 测试检查清单

- [ ] 主页可以正常访问（无需登录）
- [ ] 剧本上传功能正常（文本/文件）
- [ ] AI分析在10秒内完成
- [ ] 检测到至少3种逻辑错误
- [ ] 交互式修改功能正常
- [ ] 接受/拒绝建议功能正常
- [ ] 导出.txt格式正常
- [ ] 导出.docx格式正常
- [ ] 整体用户流程顺畅
- [ ] 无控制台错误

## 🎯 下一步行动

完成手动测试后：
1. 运行自动化测试套件: `npm test`
2. 运行E2E测试: `npm run test:e2e`
3. 记录发现的问题
4. 准备部署到生产环境

---
*测试愉快！如有问题，请查看开发服务器日志或联系技术支持。*