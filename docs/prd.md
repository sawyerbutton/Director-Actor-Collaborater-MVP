# 产品需求文档 (PRD): ScriptAI MVP

## 1. 目标和背景上下文
* **目标**: 构建一个使用3个AI Agent协作的智能助手，帮助编剧在10秒内发现并修复5种常见的剧本逻辑错误。
* **背景上下文**: 本项目是在深刻反思上一个过度工程化的项目失败后启动的。我们将严格遵循“功能优先于架构”、“简单优于复杂”的原则。
* **变更日志**:
| 日期 | 版本 | 描述 | 作者 |
| :--- | :--- | :--- | :--- |
| 2025-08-29 | 1.0 | 基于《项目简报》创建初始PRD | 约翰 (PM) |

## 2. 需求
#### **功能性需求 (Functional Requirements)**
* **FR1: 剧本输入**: 用户必须能通过粘贴文本或上传.txt/.docx文件的方式提交剧本。
* **FR2: AI协作分析**: 系统必须调用协同工作的AI Agent对剧本进行分析。
* **FR3: 逻辑错误检测**: 系统必须能够检测至少5种核心逻辑错误类型。
* **FR4: 结果与建议**: 系统必须清晰地展示检测到的错误，并为每个错误提供修改建议。
* **FR5: 交互式修改**: 用户必须能在界面上对AI建议进行“接受”或“拒绝”的操作。
* **FR6: 剧本导出**: 用户必须能够导出包含了已接受修改的新版本剧本。
* **FR7: 基础用户与项目管理**: 用户必须能通过简单的认证系统登录，并创建和管理自己的项目。

#### **非功能性需求 (Non-Functional Requirements)**
* **NFR1: 性能**: 端到端的分析响应时间必须小于10秒。
* **NFR2: 架构**: 系统必须构建为Next.js单体应用。
* **NFR3: 数据库**: 系统必须仅使用一个PostgreSQL数据库。
* **NFR4: AI供应商**: 系统必须集成DeepSeek API。
* **NFR5: 可用性**: 系统可用性必须大于95%。
* **NFR6: 测试**: 必须为AI核心逻辑编写单元测试，并为核心用户流程编写端到端测试。

## 3. 用户界面设计目标
* **整体UX愿景**: 打造一个“无干扰”的写作和修改环境，让用户能立即开始核心任务。
* **关键交互模式**: 分屏对比、上下文高亮、一键操作。
* **核心屏幕与视图**: 上传页、分析页、导出视图。
* **无障碍设计**: 目标符合 **WCAG AA** 级别标准。
* **品牌**: 采用基于shadcn/ui的干净、专业、极简的视觉风格。
* **目标设备和平台**: Web响应式，桌面优先，移动端可用。

## 4. 技术假设
* **代码仓库结构**: **单体仓库 (Monorepo/Single Repo)**。
* **服务架构**: **单体应用 + Serverless Functions**。
* **测试需求**: **核心单元测试 + 关键流程E2E测试**。
* **其他**: 仅使用DeepSeek API、仅使用PostgreSQL数据库、以Vercel/Supabase为部署平台。

## 5. Epic列表
* **Epic A: 核心逻辑与持续一致性引擎 (第1-2周)**: 实现并验证产品的AI核心，包括变更驱动的持续一致性分析。
* **Epic B: 最小可用界面 (第3周)**: 构建一个基础的用户界面，让用户能与AI分析结果进行有效交互。
* **Epic C: 最小后端支撑 (第3周)**: 搭建支撑核心功能运行所必需的后端服务、数据库和API端点。

## 6. Epic A: 核心逻辑与持续一致性引擎
**Epic目标**: 构建并验证产品的核心——一个由“一致性守护者”和“修改执行官”组成的**动态分析引擎**。它不仅能进行初始分析，还能在用户**修改设定后，智能地维护整个剧本的持续一致性**。

* **Story A.1: DeepSeek API集成与抽象层**
* **Story A.2: 剧本文本解析器**
* **Story A.3: 实现“一致性守护者”Agent**
* **Story A.4 (新): 实现变更驱动的持续一致性分析**
* **Story A.5: 实现“修改执行官”与协作框架 (范围缩小)**

## 7. Epic B: 最小可用界面
**Epic目标**: 为AI引擎穿上一件简洁、高效、实用的“外衣”，让用户能完成从上传、分析到交互的完整闭环。

* **Story B.1: 实现剧本上传与分析结果展示的基础界面**
* **Story B.2: 实现分析结果的可视化与上下文关联**
* **Story B.3: 实现核心交互功能并导出结果**

## 8. Epic C: 最小后端支撑
**Epic目标**: 快速搭建一个**极简但稳固**的后端地基，以支撑AI引擎和用户界面能够顺利运行。

* **Story C.1: 搭建Next.js单体应用后端结构**
* **Story C.2: 初始化数据库并配置ORM**
* **Story C.3: 实现核心业务API端点**
* **Story C.4: 集成简单用户认证**

## 9. 清单检查结果报告
**结论**: 这份PRD质量很高。它完整、一致，并深刻体现了我们从经验教训中提炼出的新项目原则。**它已准备好移交给架构师进行下一步工作。**

## 10. 后续步骤
* **向UX专家移交**: 基于第3节“用户界面设计目标”，使用`front-end-spec-tmpl.yaml`模板创建一份详细的UI/UX规范。
* **向架构师移交**: 在UX专家完成后，基于本PRD，使用`fullstack-architecture-tmpl.yaml`模板创建一份完整的全栈架构文档。
