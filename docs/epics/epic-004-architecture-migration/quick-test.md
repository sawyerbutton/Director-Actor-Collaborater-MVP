# Epic 004: 快速测试指南

## 🚀 5分钟快速测试流程

### 步骤1: 访问V1演示页面
打开浏览器访问: http://localhost:3000/v1-demo

### 步骤2: 创建测试项目
1. 点击 **"创建新项目"** 按钮
2. 填写信息：
   - 项目名称: "测试剧本分析"
   - 描述: "Epic 004测试"
3. 粘贴以下测试剧本内容：

```
# 测试剧本

## 第一幕
地点：咖啡店
时间：早上8点

张三走进咖啡店，点了一杯咖啡。
李四：早上好，今天天气真好。
张三：是啊，但是我记得昨天你说今天会下雨。

## 第二幕
地点：办公室
时间：早上7点  （时间线错误：比第一幕还早）

张三已经在办公室工作了两个小时。
李四刚刚到达。
李四：我刚从咖啡店过来。（逻辑错误：时间不符）
```

### 步骤3: 启动分析
1. 项目创建成功后，点击 **"开始分析"**
2. 观察进度条和状态变化
3. 等待约10-30秒完成分析

### 步骤4: 验证结果
分析完成后应该显示：
- ✅ 检测到时间线错误
- ✅ 检测到逻辑一致性问题
- ✅ 提供修改建议

### 步骤5: 检查数据持久化
1. 刷新页面
2. 项目应该仍然存在
3. 分析结果应该保留

## 📊 验证点清单

| 检查项 | 通过标准 | 状态 |
|--------|----------|------|
| 页面样式 | CSS正常显示，有颜色和布局 | ⬜ |
| 项目创建 | 显示项目ID，无错误提示 | ⬜ |
| 文件限制 | 只接受.txt/.md/.markdown | ⬜ |
| 分析启动 | 状态变为PROCESSING | ⬜ |
| 进度更新 | 进度条动态变化 | ⬜ |
| 分析完成 | 显示分析结果 | ⬜ |
| 数据持久化 | 刷新后数据仍在 | ⬜ |

## 🔍 API测试命令

```bash
# 1. 获取项目列表
curl http://localhost:3000/api/v1/projects | jq '.'

# 2. 创建测试项目
curl -X POST http://localhost:3000/api/v1/projects \
  -H "Content-Type: application/json" \
  -d '{"title":"API测试项目","content":"测试内容"}' | jq '.'

# 3. 查看项目状态（替换PROJECT_ID）
curl http://localhost:3000/api/v1/projects/PROJECT_ID/status | jq '.'
```

## 🐛 问题排查

### 如果页面没有样式：
```bash
# 重启开发服务器
pkill -f "next dev"
rm -rf .next node_modules/.cache
npm run dev
```

### 如果数据库连接失败：
```bash
# 重新初始化数据库
npx prisma db push
npx prisma generate
```

### 如果分析一直处于PROCESSING：
1. 检查控制台错误信息
2. 确认DEEPSEEK_API_KEY环境变量设置正确
3. 查看终端日志

### 如果遇到"Too many requests"错误：
```bash
# 方法1: 重启服务器（开发环境默认允许100请求/分钟）
npm run dev

# 方法2: 完全禁用开发环境的速率限制
DISABLE_RATE_LIMIT=true npm run dev
```

## ✅ 测试成功标志

当您看到以下内容时，表示测试成功：
1. 项目在列表中显示 ✅
2. 分析状态显示"COMPLETED" ✅
3. 显示检测到的逻辑错误 ✅
4. 刷新页面数据仍然存在 ✅

## 📝 测试记录

**测试日期**: ___________
**测试人员**: ___________
**测试结果**: ⬜ 通过 / ⬜ 失败

**备注**:
_________________________________
_________________________________
_________________________________